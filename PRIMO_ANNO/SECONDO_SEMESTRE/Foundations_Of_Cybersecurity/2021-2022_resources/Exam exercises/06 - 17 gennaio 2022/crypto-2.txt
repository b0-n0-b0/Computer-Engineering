EXERCISE

For identification, Alice and Bob share a PIN composed of d = 4 digits, and perform the 
following challenge-response protocol: 
1. M1 A -> B: CHL
2. M2 B -> A: RSP
with CHL challenge message and RSP response message.

Indicate which one of the following implementations of CHL and RSP is secure w.r.t. 
an off-line password-guessing attack. For each one, estimate the attack complexity.
1. CHL = ra and RSP = E(K, ra);
2. CHL = ra and RSP = E(K, ra||rb);
3. CHL = ra and RSP = H(K, ra||rb);
4. CHL = ra and RSP = E(pubkA, t) with t = H(k, ra);
5. CHL = ra and RSP = E(pubkA, t||rb) with t = H(k, ra).
where:
- ra and rb are nonces generated by Alice and Bob, respectively;
- K is a symmetric key, with K = h(PIN), where h is a secure hash function; and, 
finally;
- pubkA is Aâ€™s public key, known to B.

SOLUTION
First of all notice that the complexity of a guessing attack against the PIN is O(10^4).

Case 1 is insecure. The adversary guesses a password, computes a key and decrypts 
RSP. Then (s)he compares the resulting plaintext with ra. It follows the complexity of 
the attack is equal to the password-guessing attack.

Case 2 is insecure. The adversary guesses a password, computes a key and decrypts 
RSP. Then (s)he compares the resulting plaintext with the first field of the resulting 
plaintext. It follows the complexity of the attack is equal to the password-guessing 
attack.

Case 3 is insecure. A is not able to verify RSP because (s)he does not know rb.

Case 4 is insecure. The adversary guesses a password and computes a key. Then 
(s)he computes the MAC of ra, encrypts it by means of pubkA, and checks whether it is 
equal to RSP. It follows the complexity of the attack is equal to the passwordguessing attack.

Case 5 is secure, because rb randomizes RSP.